name: Publish helm chart

on:
  push:
    branches:
      - master
    paths:
      - 'charts/**'

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - uses: azure/setup-helm@v1
      id: installhelm3
      with:
        version: 'v3.0.3'
    - name: Publish helm charts
      uses: funkypenguin/helm-gh-pages-action@v1.1.1
      with:
        # A personal access token needed to push your site after it has been built.
        access-token: ${{ secrets.GITHUB_PERSONAL_ACCESS_TOKEN }}
        # The branch expected by GitHub to have the static files needed for your site.
        deploy-branch: helm-charts
        # The folder in which the helm charts are located
        charts-folder: charts

    # - name: Discord notification
    #   env:
    #     DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
    #   uses: Ilshidur/action-discord@master
    #   with:
    #     args: |
    #       Greetings, geeks!  ðŸ¤“

    #       A new/updated helm âŽˆ chart is fresh out of the oven!
          
    #       Here's what's changed:
    #       > ${{github.event.commits[0].message}}

    #       Get more details at:
    #       {{ EVENT_PAYLOAD.compare }}